rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sample_tissue_types = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
for(i in 1:ncol(sample_tissue_types)){
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[2]
}
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
for(i in 1:ncol(sample_tissue_types)){
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
}
View(Cellline_Tissue)
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
low_sample_drugs = c(1,3,4,5,6,7,12,13,14,19,20,21,22,23,24,25,28,29,31,33,36,37
,39,40,41,42,43,45,47,49,51,52,56,57,58)
sen_PRISM = readRDS("Processed_data/S23/sensitivity_matrix_PRISM_with@TCGA@drugs.rds")
#res_TCGA = readRDS("Processed_data/S23/Drug_response_matrix_TCGA.rds")
sen_PRISM = sen_PRISM[,-low_sample_drugs]
t =readRDS("Processed_data/Other/24_drugs.rds")
View(t)
View(t)
saveRDS(sen_PRISM,"Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
View(sen)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_types = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
for(i in 1:ncol(sample_tissue_types)){
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
}
View(Cellline_Tissue)
nrow(sample_tissue_types)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_types = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
i=1
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
which(sample_tissue_types[,i]==1),2
which(sample_tissue_types[,i]==1)
colnames(sample_tissue_types)[i]
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
i=1
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
colnames(sample_tissue_types)
colnames(sample_tissue_types)[i]
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
i
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),1]
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
Cellline_Tissue[which(sample_tissue_types[,i]==1),1]
i
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2]
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),1]
Cellline_Tissue[which(sample_tissue_types[,i]==1),2]
colnames(sample_tissue_types)[i]
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
Cellline_Tissue[which(sample_tissue_types[,i]==1),2]
which(sample_tissue_types[,i]==1)
which(sample_tissue_types[,i]==1)
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
View(Cellline_Tissue)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_types = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
for(i in 1:ncol(sample_tissue_types)){
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
}
View(Cellline_Tissue)
class(Cellline_Tissue)
dim(Cellline_Tissue)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_types = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_types),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_types)
for(i in 1:ncol(sample_tissue_types)){
Cellline_Tissue[which(sample_tissue_types[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_types[,i]==1),2] = colnames(sample_tissue_types)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
ncol(sample_tissue_types)
i=1
Cellline_Tissue[,1]%in% i
s = sen[Cellline_Tissue[,1]%in% i,]
View(s)
s = apply(sen[Cellline_Tissue[,1]%in% i,],1,sum,na.rm = TRUE)
s
d = sen[Cellline_Tissue[,1]
}
d = sen[Cellline_Tissue[,1],]
d = sen[Cellline_Tissue[,1]%in% i,]
View(d)
sum(d[1,],na.rm = TRUE)
Cellline_Tissue[,1] %in% i
Tissue_Sen = matrix(0,ncol(sample_tissue_types),ncol(sen))
View(Tissue_Sen)
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[which(sample_tissue_one_hot[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_one_hot[,i]==1),2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
i=1
s = apply(sen[Cellline_Tissue[,1] %in% i,],1,sum,na.rm = TRUE)
ncol(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],1,sum,na.rm = TRUE)
}
apply(sen[Cellline_Tissue[,1] %in% i,],1,sum,na.rm = TRUE)
length( apply(sen[Cellline_Tissue[,1] %in% i,],1,sum,na.rm = TRUE))
sen[Cellline_Tissue[,1] %in% i,]
g = sen[Cellline_Tissue[,1] %in% i,]
View(g)
dim(g)
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],2,sum,na.rm = TRUE)
}
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[which(sample_tissue_one_hot[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_one_hot[,i]==1),2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],2,sum,na.rm = TRUE)
}
i
ncol(sample_tissue_one_hot)
sen[Cellline_Tissue[,1] %in% i,]
Cellline_Tissue[,1] %in% i
sum(Cellline_Tissue[,1] %in% i)
View(Cellline_Tissue)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
View(Cellline_Tissue)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[which(sample_tissue_one_hot[,i]==1),1] = i
Cellline_Tissue[which(sample_tissue_one_hot[,i]==1),2] = colnames(sample_tissue_one_hot)[i]
}
View(Cellline_Tissue)
sample_tissue_one_hot[,i]==1
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
which(Cellline_Tissue[,1] == 23)
Cellline_T = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
View(Cellline_T)
dim(Cellline_T)
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
which(Cellline_Tissue[,1] == 23
which(Cellline_Tissue[,1] == 23)
which(Cellline_Tissue[,1] == 23)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
which(Cellline_Tissue[,1] == 23)
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
sen = sen[rownames(Cellline_Tissue),]
View(Cellline_Tissue)
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],2,sum,na.rm = TRUE)
}
View(Cellline_Tissue)
View(Tissue_Sen)
dim(Tissue_Sen)
View(Cellline_Tissue)
Tissue_Sen = Tissue_Sen[-23,]
View(sample_tissue_one_hot)
sample_tissue_one_hot = sample_tissue_one_hot[,-23]
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
sample_tissue_one_hot = sample_tissue_one_hot[,-23]
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
dim(Cellline_Tissue)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
sample_tissue_one_hot = sample_tissue_one_hot[,-23]
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
sen = sen[rownames(Cellline_Tissue),]
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],2,sum,na.rm = TRUE)
}
Tissue_Sen = Tissue_Sen[-23,]
View(sample_tissue_one_hot)
sample_tissue_one_hot = sample_tissue_one_hot[,-23]
View(sample_tissue_one_hot)
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],2,sum,na.rm = TRUE)
}
Corr = cor(Tissue_Sen)
View(Tissue_Sen)
Corr = cor(t(Tissue_Sen))
is.na(Tissue_Sen)
sum(is.na(Tissue_Sen))
r = t(Tissue_Sen)
dim(r)
Corr = cor(r)
View(Corr)
View(Cellline_Tissue)
which(Cellline_Tissue[,1] == 24)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
dim(Cellline_Tissue)
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
dim(Cellline_Tissue)
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 24),]
dim(Cellline_Tissue)
dim(sen)
sen = sen[rownames(Cellline_Tissue),]
dim(sen)
sample_tissue_one_hot = sample_tissue_one_hot[,c(-23,-24)]
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
View(sample_tissue_one_hot)
colnmaes(sample_tissue_one_hot)
colnames(sample_tissue_one_hot)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
sample_tissue_one_hot = readRDS("Processed_data/S19/sample_tissue_types.rds")
Cellline_Tissue = matrix(0,nrow(sample_tissue_one_hot),2)
rownames(Cellline_Tissue) = rownames(sample_tissue_one_hot)
for(i in 1:ncol(sample_tissue_one_hot)){
Cellline_Tissue[sample_tissue_one_hot[,i]==1,1] = i
Cellline_Tissue[sample_tissue_one_hot[,i]==1,2] = colnames(sample_tissue_one_hot)[i]
}
Cellline_Tissue = Cellline_Tissue[rownames(sen),]
# Removing "fibroblast" and "rhabdomyosarcoma" samples from Cellline_Tissue and sensitivity matrix
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 23),]
Cellline_Tissue = Cellline_Tissue[-which(Cellline_Tissue[,1] == 24),]
sen = sen[rownames(Cellline_Tissue),]
# Removing "fibroblast" and "rhabdomyosarcoma" tissues from sample_tissue_one_hot
sample_tissue_one_hot = sample_tissue_one_hot[,c(-23,-24)]
Tissue_Sen = matrix(0,ncol(sample_tissue_one_hot),ncol(sen))
rownames(Tissue_Sen) = colnames(sample_tissue_one_hot)
colnames(Tissue_Sen) = colnames(sen)
for(i in 1:ncol(sample_tissue_one_hot)){
Tissue_Sen[i,] = apply(sen[Cellline_Tissue[,1] %in% i,],2,sum,na.rm = TRUE)
}
dim(Tissue_Sen)
r = t(Tissue_Sen)
dim(r)
Corr = cor(r)
View(Corr)
Corr = cor(t(Tissue_Sen))
min(Corr)
dist = as.dist(1-cor(t(Tissue_Sen)))
pheatmap::pheatmap(dist)
dists = as.dist(1-cor(t(Tissue_Sen)))
Tree = hclust(dists,method="ward.D")
clusters = cutree(Tree, k=k)
plot(tree)
plot(Tree)
? hclust
dists = as.dist(1-cor(t(Tissue_Sen)))
Tree = hclust(dists,method="single")
plot(Tree)
Tree = hclust(dists,method="complete")
plot(Tree)
dists = as.dist(1-cor(t(Tissue_Sen)))
Tree = hclust(dists,method="ward.D")
plot(Tree)
clusters = cutree(Tree, k=4)
table(clusters)
col.pal = RColorBrewer::brewer.pal(9, "Reds")
pheatmap::pheatmap(dists,show_rownames=F, show_colnames=F, treeheight_row = 0,
clustering_method = "ward.D", cutree_cols=k)
pheatmap::pheatmap(dists,show_rownames=F, show_colnames=F, treeheight_row = 0,
clustering_method = "ward.D", cutree_cols=4)
Tree = hclust(dists,method="ward.D2")
plot(Tree)
Tree = hclust(dists,method="ward.D")
plot(Tree)
table(clusters)
clusters
pheatmap::pheatmap(dists[Tree$order,Tree$order],
cluster_row = F,
cluster_cols = F,
show_rownames=F, show_colnames=F,
fontsize = 6.5, fontsize_row=6,fontsize_col = 6)
Tree$order
pheatmap::pheatmap(dists,show_rownames=FALSE, show_colnames=FALSE, treeheight_row = 0,
cutree_cols=k, cutree_rows=k)
k=4
pheatmap::pheatmap(dists,show_rownames=FALSE, show_colnames=FALSE, treeheight_row = 0,
cutree_cols=k, cutree_rows=k)
pheatmap::pheatmap(dists,show_rownames=FALSE, show_colnames=FALSE, treeheight_row = 0,
cutree_cols=k, cutree_rows=k, clustering_method = "ward.D")
k=5
pheatmap::pheatmap(dists,show_rownames=FALSE, show_colnames=FALSE, treeheight_row = 0,
cutree_cols=k, cutree_rows=k, clustering_method = "ward.D")
k=6
pheatmap::pheatmap(dists,show_rownames=FALSE, show_colnames=FALSE, treeheight_row = 0,
cutree_cols=k, cutree_rows=k, clustering_method = "ward.D")
k=4
pheatmap::pheatmap(dists[Tree$order,Tree$order],
cluster_row = F,
cluster_cols = F,
show_rownames=F, show_colnames=F,
fontsize = 6.5, fontsize_row=6,fontsize_col = 6)
Tree$order
dim(dists)
pheatmap::pheatmap(1-cor(t(Tissue_Sen))[Tree$order,Tree$order],
cluster_row = F,
cluster_cols = F,
show_rownames=F, show_colnames=F,
fontsize = 6.5, fontsize_row=6,fontsize_col = 6)
dists = as.dist(1-cor(t(Tissue_Sen)))
Tree = hclust(dists,method="ward.D")
plot(Tree)
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
TCGA_Patients = readRDS("Processed_data/S22/TCGA_Patients.rds")
TCGA_Patients = data.frame(TCGA_Patients)
colnames(TCGA_Patients) = c("Cancer_type", "Patient", "Drug","Response","Cancer_type_Perfect_name")
N_Cancer = readRDS("Processed_data/S22/Number_of_each_Cancer_TCGA.rds")
low_sample_drugs = c(1,3,4,5,6,7,12,13,14,19,20,21,22,23,24,25,28,29,31,33,36,37
,39,40,41,42,43,45,47,49,51,52,56,57,58)
res_TCGA = readRDS("Processed_data/S24/Drug_response_TCGA_binarized.rds")
res_TCGA = res_TCGA[,-low_sample_drugs]
N_drug = ncol(res_TCGA)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
TCGA_Patients = readRDS("Processed_data/S22/TCGA_Patients.rds")
TCGA_Patients = data.frame(TCGA_Patients)
colnames(TCGA_Patients) = c("Cancer_type", "Patient", "Drug","Response","Cancer_type_Perfect_name")
N_Cancer = readRDS("Processed_data/S22/Number_of_each_Cancer_TCGA.rds")
low_sample_drugs = c(1,3,4,5,6,7,12,13,14,19,20,21,22,23,24,25,28,29,31,33,36,37
,39,40,41,42,43,45,47,49,51,52,56,57,58)
res_TCGA = readRDS("Processed_data/S24/Drug_response_TCGA_binarized.rds")
res_TCGA = res_TCGA[,-low_sample_drugs]
saveRDS(res_TCGA,"Processed_data/Other/Res_TCGA_24_Drugs.rds")
res_TCGA = readRDS("Processed_data/Other/Res_TCGA_24_Drugs.rds")
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
TCGA_Patients = readRDS("Processed_data/S22/TCGA_Patients.rds")
TCGA_Patients = data.frame(TCGA_Patients)
colnames(TCGA_Patients) = c("Cancer_type", "Patient", "Drug","Response","Cancer_type_Perfect_name")
N_Cancer = readRDS("Processed_data/S22/Number_of_each_Cancer_TCGA.rds")
res_TCGA = readRDS("Processed_data/Other/Res_TCGA_24_Drugs.rds")
N_drug = ncol(res_TCGA)
drugs = data.frame(colnames(res_TCGA))
NO_tissues = list()
for (i in drugs[,1]){
y = res_TCGA[!is.na(res_TCGA[,i]),i]
length(y)
y = data.frame(y)
yy = TCGA_Patients[TCGA_Patients$Patient %in% rownames(y) & TCGA_Patients$Drug == i,]
yy = yy[!duplicated(yy$Patient),]
rownames(yy) = yy$Patient
patient_cancer_drug_res = yy[rownames(y),]
patient_cancer_drug_res$binarized_response = y[,1]
patient_cancer_res = patient_cancer_drug_res[,c(1,6)]
Table = table(patient_cancer_res)
Sum = cbind(sum(Table[,1]),sum(Table[,2]))
Table = rbind(Table, Sum)
NO_tissues[i] = list(Table)
}
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
TCGA_Patients = readRDS("Processed_data/S22/TCGA_Patients.rds")
View(TCGA_Patients)
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
TCGA_Patients = readRDS("Processed_data/S22/TCGA_Patients.rds")
View(TCGA_Patients)
N_Cancer = readRDS("Processed_data/S22/Number_of_each_Cancer_TCGA.rds")
N_Cancer
View(N_Cancer)
N_Cancer_TCGA = readRDS("Processed_data/S22/Number_of_each_Cancer_TCGA.rds")
View(N_Cancer_TCGA)
