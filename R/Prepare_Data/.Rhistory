library(igraph)
install.packages("igraph")
library(igraph)
install.packages("igraph")
install.packages("igraph")
library(igraph)
BiocManager::install("igraph")
library(dorothea)
library(ggplot2)
library(dplyr)
net <- dorothea::dorothea_hs
head(net)
n_genes <- net %>%
group_by(tf) %>%
summarize(n = n())
ggplot2(data=n_genes, aes(x=n)) +
geom_density() +
theme(text = element_text(size=12)) +
xlab('Number of target genes') +
ylab('densities') +
theme_bw() +
theme(legend.position = "none")
library(ggplot2)
ggplot(data=n_genes, aes(x=n)) +
geom_density() +
theme(text = element_text(size=12)) +
xlab('Number of target genes') +
ylab('densities') +
theme_bw() +
theme(legend.position = "none")
c(1:10) %>% mean()
mean(c(1:10))
# use example gene expression matrix from bcellViper package
library(bcellViper)
# use example gene expression matrix from bcellViper package
library(bcellViper)
data(bcellViper, package = "bcellViper")
rm(list=ls())
library(dorothea)
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
GE = readRDS("Processed_Data/expresion_matrix.rds")
sen = readRDS("Processed_Data/sensitivity_matrix.rds")
library(dorothea)
data(dorothea_hs)
force(dorothea_hs)
data(dorothea_hs, package = "dorothea")
force(dorothea_hs)
View(dorothea_hs)
data(dorothea_hs)
View(dorothea_hs)
rm(list=ls())
data(dorothea_hs, package = "dorothea")
tf_activities <- run_viper(GE, dorothea_hs,
options =  list(method = "scale", minsize = 4,
eset.filter = FALSE, cores = 1,
verbose = FALSE))
GE = readRDS("Processed_Data/expresion_matrix.rds")
sen = readRDS("Processed_Data/sensitivity_matrix.rds")
GE = t(GE)
tf_activities <- run_viper(GE, dorothea_hs,
options =  list(method = "scale", minsize = 4,
eset.filter = FALSE, cores = 1,
verbose = FALSE))
View(tf_activities)
dim(tf_activities)
X = t(tf_activities)
dim(X)
GE = t(tf_activities)
i = 325                            # drug number
X = GE[!is.na(sen[,i]),]
y = sen[!is.na(sen[,i]),i]
# Normalization
X = scale(X)
y = scale(y)
Rep = 1
MSE = rep(0,Rep)
Corr = rep(0,Rep)
## Split data into train & test
sample = sample.split(y, SplitRatio = .8)
require(caTools)
library(randomForest)
## Split data into train & test
sample = sample.split(y, SplitRatio = .8)
Xtr_val = subset(X, sample == TRUE)
Xtest  = subset(X, sample == FALSE)
ytr_val = subset(y, sample == TRUE)
ytest  = subset(y, sample == FALSE)
Xtrain = Xtr_val
ytrain = ytr_val
ytrain = as.vector(ytrain)
ytest = as.vector(ytest)
Cor = abs(cor(Xtrain,ytrain))
Cor_ind = order(Cor,decreasing = TRUE)
# hyperparameters
N1 = 300
N2 = N1+200
inf_gene_ind = Cor_ind[1:N1]
inf_gene = my_genes[inf_gene_ind]
## Find Diffused genes
InitialScores = setNames(rep(0,length(my_genes)), my_genes)
RF = randomForest(y = ytrain,x = Xtrain, ntree = 200,mtry = 100)
y_pred = predict(RF, newdata=Xtest)
MSE[j] = mean((ytest - y_pred)^2)
Corr[j] = cor(ytest, y_pred, method = "pearson")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
View(dorothea_hs)
viper_regulons = df2regulon(dorothea_hs)
View(viper_regulons)
View(dorothea_hs)
View(viper_regulons)
tf_activities <- run_viper(GE, viper_regulons,
options =  list(method = "scale", minsize = 4,
eset.filter = FALSE, cores = 1,
verbose = FALSE))
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
checkCarnivalOptions(carnivalOptions)
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/Step10-DoRothEA.R")
