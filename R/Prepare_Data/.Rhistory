L1 = c()
L2 = c()
L3 = c()
L4 = c()
L5 = c()
L6 = c()
L7 = c()
L8 = c()
L9 = c()
L10 = c()
ind_L1 = c()
ind_L2 = c()
ind_L3 = c()
ind_L4 = c()
ind_L5 = c()
ind_L6 = c()
ind_L7 = c()
ind_L8 = c()
ind_L9 = c()
ind_L10 = c()
index_max1 = which.max(len)
ind_L1 = c(ind_L1, index_max1)
l1 = Drug_Pathways_i[index_max1]
L1 = c(L1, l1)
ind = rbind(ind, cbind("L1", l1, index_max1, len[index_max1]))
len_intersect = c()
ind_rest = which(len != 0)
for(k in ind_rest){
len_intersect = c(len_intersect, length(intersect(unlist(entrez[[index_max1]]),
unlist(entrez[[Drug_Pathways_i[[k]]]]))))
}
len_s1 = ifelse(len[ind_rest]-len_intersect==0,0,len[ind_rest])
zeros1 = ind_rest[len_s1 == 0]
R1 = ind_rest[!ind_rest %in% zeros1]
zeros1
len2 = len
len2[!((1:length(len)) %in% zeros1)]=0
len2[index_max1]=0
index_max2 = which.max(len2)
ind_L2 = c(ind_L2, index_max2)
l2 = Drug_Pathways_i[index_max2]
L2 = c(L2, l2)
ind = rbind(ind, cbind("L2", l2, index_max2, len[index_max2]))
len_intersect = c()
ind_rest = which(len2 != 0)
for(k in ind_rest){
len_intersect = c(len_intersect, length(intersect(unlist(entrez[[index_max2]]),
unlist(entrez[[Drug_Pathways_i[[k]]]]))))
}
len_s = ifelse(len[ind_rest]-len_intersect==0,0,len[ind_rest])
zeros2 = ind_rest[len_s == 0]
R2 = ind_rest[!ind_rest %in% zeros2]
len3 = len
len3[!((1:length(len)) %in% zeros2)]=0
len3[index_max2]=0
len3
index_max3 = which.max(len3)
ind_L3 = c(ind_L3, index_max3)
l3 = Drug_Pathways_i[index_max3]
L3 = c(L3, l3)
ind = rbind(ind, cbind("L3", l3, index_max3, len[index_max3]))
len_intersect = c()
ind_rest = which(len3 != 0)
for(k in ind_rest){
len_intersect = c(len_intersect, length(intersect(unlist(entrez[[index_max3]]),
unlist(entrez[[Drug_Pathways_i[[k]]]]))))
}
len_s = ifelse(len[ind_rest]-len_intersect==0,0,len[ind_rest])
zeros = ind_rest[len_s == 0]
len_zeros = len[zeros]
len4 = len
len4[!((1:length(len)) %in% zeros)]=0
len4[index_max3]=0
len4
index_max4 = which.max(len4)
ind_L4 = c(ind_L4, index_max4)
l4 = Drug_Pathways_i[index_max4]
L4 = c(L4, l4)
ind = rbind(ind, cbind("L4", l4, index_max4, len[index_max4]))
len_intersect = c()
ind_rest = which(len4 != 0)
for(k in ind_rest){
len_intersect = c(len_intersect, length(intersect(unlist(entrez[[index_max4]]),
unlist(entrez[[Drug_Pathways_i[[k]]]]))))
}
len_s = ifelse(len[ind_rest]-len_intersect==0,0,len[ind_rest])
zeros = ind_rest[len_s == 0]
len_zeros = len[zeros]
len5 = len
len5[!((1:length(len)) %in% zeros)]=0
len5[index_max4]=0
len5
zeros1
len
View(entrez)
zeros1
#if(sum(len_s1)){
len[zeros1]=0
len
index_max1 = which.max(len)
index_max1
len4
zeros
sum(len4)!=0
len
Drug_Pathways_i
names(len)=Drug_Pathways_i
len
zeros
length(zeros)==1
zeros
rm(list=ls())
library(reactome.db)
drug = "cisplatin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len_genes = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len_genes = c(len_genes, length(unlist(entrez[[j]])))
}
ind = c()
len = len_genes
L1 = c()
L2 = c()
L3 = c()
L4 = c()
L5 = c()
L6 = c()
L7 = c()
L8 = c()
L9 = c()
L10 = c()
ind_L1 = c()
ind_L2 = c()
ind_L3 = c()
ind_L4 = c()
ind_L5 = c()
ind_L6 = c()
ind_L7 = c()
ind_L8 = c()
ind_L9 = c()
ind_L10 = c()
index_max1 = which.max(len)
index_max1 = which.max(len)
ind_L1 = c(ind_L1, index_max1)
l1 = Drug_Pathways_i[index_max1]
L1 = c(L1, l1)
ind = rbind(ind, cbind("L1", l1, index_max1, len[index_max1]))
View(ind)
len_intersect = c()
ind_rest = which(len != 0)
for(k in ind_rest){
len_intersect = c(len_intersect, length(intersect(unlist(entrez[[index_max1]]),
unlist(entrez[[Drug_Pathways_i[[k]]]]))))
}
len_s1 = ifelse(len[ind_rest]-len_intersect==0,0,len[ind_rest])
zeros1 = ind_rest[len_s1 == 0]
zeros1
names(len) = Drug_Pathways_i
len
index_max1 = which.max(len)
index_max1
names(which.max(len))
pw_max = names(which.max(len))
pw_max
len[pw_max]
len
entrez[[pw]]
entrez[[pw_max]]
View(entrez)
pw_max = names(which.max(len))
pw_max
names(len)
for(k in names(len)){
len_intersect = length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]])))
}
len_intersect
rm(list=ls())
library(reactome.db)
drug = "doxorubicin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len = c(len, length(unlist(entrez[[j]])))
}
names(len) = Drug_Pathways_i
##### Level 1
ind = c()
##### Level 1
PW = c()
pw_max = names(which.max(len))
PW = rbind(ind, cbind("L1", pw_max, len[pw_max]))
for(k in names(len)){
len_intersect = length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]])))
}
len_intersect
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_intersect
len
len_s1 = ifelse(len-len_intersect==0,0,len)
len_s1
zeros1 = names[len_s1 == 0]
names(len_s1)[len_s1 == 0]
zeros1 = names(len_s1)[len_s1 == 0]
inner_pw = inter_pathway(pw_max, len, entrez)
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = names(len_s1)[len_s1 == 0]
return(inner_pw)
}
inner_pw = inter_pathway(pw_max, len, entrez)
inner_pw
len_s1
inner_pw = len_s1[len_s1 == 0]
inner_pw
inner_pw = len[len_s1 == 0]
inner_pw
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = len[len_s1 == 0]
return(inner_pw)
}
inner_pw = inter_pathway(pw_max, len, entrez)
inner_pw
pw_max = names(which.max(inner_pw))
pw_max
PW = rbind(ind, cbind("L2", pw_max, len[pw_max]))
View(PW)
PW = rbind(PW, cbind("L2", pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
inner_pw
rm(list=ls())
library(reactome.db)
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = len[len_s1 == 0]
return(inner_pw)
}
drug = "doxorubicin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len = c(len, length(unlist(entrez[[j]])))
}
names(len) = Drug_Pathways_i
##### Level 1
PW = c()
pw_max = names(which.max(len))
PW = rbind(PW, cbind("L1", pw_max, len[pw_max]))
pw_max
PW
inner_pw = inter_pathway(pw_max, len, entrez)
inner_pw
pw_max
PW
inner_pw
inner_pw[pw_max]
inner_pw[pw_max]=0
inner_pw
inner_pw = inner_pw[-pw_max]
inner_pw = inner_pw[-names(pw_max)]
-names(pw_max)
inner_pw
intersect(inner_pw,pw_max)
inner_pw[names(inner_pw) != pw_max]
inner_pw
inner_pw = inner_pw[names(inner_pw) != pw_max]
inner_pw
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = len[len_s1 == 0]
inner_pw = inner_pw[names(inner_pw) != pw_max]
return(inner_pw)
}
pw_max
pw_max = names(which.max(inner_pw))
PW = rbind(PW, cbind("L2", pw_max, len[pw_max]))
pw_max
inner_pw
PW = rbind(PW, cbind("L2", pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
inner_pw
rm(list=ls())
library(reactome.db)
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = len[len_s1 == 0]
inner_pw = inner_pw[names(inner_pw) != pw_max]
return(inner_pw)
}
drug = "doxorubicin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len = c(len, length(unlist(entrez[[j]])))
}
names(len) = Drug_Pathways_i
##### Level 1
PW = c()
pw_max = names(which.max(len))
PW = rbind(PW, cbind("L1", pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
while(sum(inner_pw)){
pw_max = names(which.max(inner_pw))
PW = rbind(PW, cbind("L2", pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
}
##### Level 1
PW = c()
pw_max = names(which.max(len))
PW = rbind(PW, cbind("L1", pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
##### Level 1
PW = c()
pw_max = names(which.max(len))
PW = rbind(PW, cbind(1, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i=2
while(sum(inner_pw)){
pw_max = names(which.max(inner_pw))
PW = rbind(PW, cbind(i, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i = i+1
}
View(entrez)
rm(list=ls())
library(reactome.db)
drug = "doxorubicin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len_genes = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len_genes = c(len_genes, length(unlist(entrez[[j]])))
}
##### Level 1
ind = c()
len = len_genes
L1 = c()
ind_L1 = c()
ind_L2 = c()
ind_L3 = c()
index_max1 = which.max(len)
ind_L1 = c(ind_L1, index_max1)
l1 = Drug_Pathways_i[index_max1]
L1 = c(L1, l1)
ind = rbind(ind, cbind("L1", l1, index_max1, len[index_max1]))
len_intersect = c()
ind_rest = which(len != 0)
for(k in ind_rest){
len_intersect = c(len_intersect, length(intersect(unlist(entrez[[index_max1]]),
unlist(entrez[[Drug_Pathways_i[[k]]]]))))
}
len_s1 = ifelse(len[ind_rest]-len_intersect==0,0,len[ind_rest])
zeros1 = ind_rest[len_s1 == 0]
len2 = len
len2[!((1:length(len)) %in% zeros1)]=0
len2[index_max1]=0
len2
zeros1
inner_pw
rm(list=ls())
library(reactome.db)
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = len[len_s1 == 0]
inner_pw = inner_pw[names(inner_pw) != pw_max]
return(inner_pw)
}
drug = "doxorubicin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len = c(len, length(unlist(entrez[[j]])))
}
names(len) = Drug_Pathways_i
##### Level 1
PW = c()
pw_max = names(which.max(len))
PW = rbind(PW, cbind(1, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i=2
while(sum(inner_pw)){
pw_max = names(which.max(inner_pw))
PW = rbind(PW, cbind(i, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i = i+1
}
inner_pw
len = len[names(len) != PW[nrow(PW),2]]
len
##### Level 1
PW = c()
while (sum(len)){
pw_max = names(which.max(len))
PW = rbind(PW, cbind(1, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i=2
while(sum(inner_pw)){
pw_max = names(which.max(inner_pw))
PW = rbind(PW, cbind(i, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i = i+1
}
len = len[names(len) != PW[nrow(PW),2]]
}
rm(list=ls())
library(reactome.db)
##Function
inter_pathway = function(pw_max, len, entrez){
len_intersect = c()
for(k in names(len)){
len_intersect = c(len_intersect,length(intersect(unlist(entrez[[pw_max]]),unlist(entrez[[k]]))))
}
len_s1 = ifelse(len-len_intersect==0,0,len)
inner_pw = len[len_s1 == 0]
inner_pw = inner_pw[names(inner_pw) != pw_max]
return(inner_pw)
}
drugs = c("doxorubicin", "temozolomide", "bicalutamide", "docetaxel",
"etoposide", "capecitabine", "vinorelbine", "paclitaxel",
"leucovorin", "cyclophosphamide", "methotrexate", "epirubicin",
"dacarbazine", "anastrozole", "sorafenib", "ifosfamide", "gemcitabine",
"tamoxifen", "vincristine", "irinotecan","cisplatin","oxaliplatin",
"carboplatin", "vinblastine")
drug = "doxorubicin"
Drug_Pathways = readRDS("Processed_data/S26/Drug_Pathways.rds")
path2gene = as.list(reactomePATHID2EXTID)
Drug_Pathways_i = Drug_Pathways[[drug]]
Drug_Pathways_i = unlist(Drug_Pathways_i)
entrez = list()
len = c()
for(j in Drug_Pathways_i){
entrez[[j]] = list(path2gene[[j]])
len = c(len, length(unlist(entrez[[j]])))
}
names(len) = Drug_Pathways_i
##### Level 1
PW = c()
while (sum(len)){
pw_max = names(which.max(len))
PW = rbind(PW, cbind(1, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i=2
while(sum(inner_pw)){
pw_max = names(which.max(inner_pw))
PW = rbind(PW, cbind(i, pw_max, len[pw_max]))
inner_pw = inter_pathway(pw_max, len, entrez)
i = i+1
}
len = len[names(len) != PW[nrow(PW),2]]
}
