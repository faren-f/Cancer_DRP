library(igraph)
install.packages("igraph")
library(igraph)
install.packages("igraph")
install.packages("igraph")
library(igraph)
BiocManager::install("igraph")
## Distribution of drug-drug similarity matrix
sim_FP = readRDS("Data/Processed_Data/Fingerprints_sim.rds")
setwd("~/Desktop/Codes/Cancer_DRP/R")
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
View(Result_each_Model)
Result_each_Model[[1]]
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
dR_PRISM = read.table("Processed_data/S34/gsea2_PRISM.csv",sep = ",",header = TRUE, row.names = 1)
class(dR_PRISM)
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF21-ModelComparison_TrainPRISM_TestTCGA_Landmark.R")
View(Result_each_Model)
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
i=1
pathway_gene_set = Drug_Pathway_gene_set_eachTarget(drug = i, level=1)[["all"]]
!isEmpty(pathway_gene_set)
source("F22-Drug_Pathway_Level_genes_eachTarget.R")
source("F18-Combat_Normalization.R")
source("F7-RandomForest.R")
pathway_gene_set = Drug_Pathway_gene_set_eachTarget(drug = i, level=1)[["all"]]
!isEmpty(pathway_gene_set)
I = intersect(colnames(GE_PRISM),pathway_gene_set)
X = GE_PRISM[,I]
X_TCGA = GE_TCGA[,I]
N_genes = length(I)
Xtrain = X[!is.na(sen_PRISM[,i]),]
ytrain = sen_PRISM[!is.na(sen_PRISM[,i]),i]
Xtest = X_TCGA[!is.na(res_TCGA[,i]),]
ytest = res_TCGA[!is.na(res_TCGA[,i]),i]
length(ytest)
X_Normalization = Combat_Scale(Xtrain,Xtest)
Xtrain = X_Normalization[[1]]
Xtest = X_Normalization[[2]]
# Ytrain normalization
ytrain = scale(ytrain)
ytrain = ytrain[,1]
# Models
result = c()
Models
for(M in Models){
model = get(M)
y_pred = model(ytrain = ytrain ,Xtrain = Xtrain,Xtest = Xtest)
corr = cor(ytest,y_pred)
ttest = t.test(y_pred[ytest==1], y_pred[ytest==2], alternative="greater")$p.value
Ranksum = wilcox.test(y_pred[ytest==1], y_pred[ytest==2], alternative ="greater")$p.value
result = rbind(result, c(corr, ttest, Ranksum, N_genes))
}
result
corr = 0
ttest = 1
Ranksum = 1
N_genes = 0
result = rbind(result, c(corr, ttest, Ranksum, N_genes))
corr = 0
ttest = 1
Ranksum = 1
N_genes = 0
result = rbind(result, c(corr, ttest, Ranksum, N_genes))
result
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
View(result)
result[["doxorubicin"]]
result[["oxaliplatin"]]
Models
corr = 0
ttest = 1
Ranksum = 1
N_genes = 0
result = c()
result = rbind(result, c(corr, ttest, Ranksum, N_genes))
result
result = rbind(result, c(corr, ttest, Ranksum, N_genes))*5
result
result = (rbind(result, c(corr, ttest, Ranksum, N_genes)))*5
result
result = c()
for(rep in 1:5){
result = rbind(result, c(corr, ttest, Ranksum, N_genes))
}
result
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
View(result)
View(result)
result[["doxorubicin"]]
Result = data.frame()
for (k in drugs){
Result = rbind(Result, result[[k]])
}
View(Result)
N_Models = length(Models)
Result_each_Model = list()
for(m in 1:N_Models){
R = Result[m,]
for(d in seq(N_Models,(N_Models*N_drug)-1,N_Models)){
R = rbind(R, Result[m+d,])
}
Result_each_Model[m] = list(R)
}
length(drugs)
N_Models = length(Models)
Result_each_Model = list()
for(m in 1:N_Models){
R = Result[m,]
for(d in seq(N_Models,(N_Models*length(drugs))-1,N_Models)){
R = rbind(R, Result[m+d,])
}
Result_each_Model[m] = list(R)
}
stopCluster(cl)
View(Result_each_Model)
Result_each_Model[[1]]
Result_each_Model[[2]]
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
View(Result_each_Model)
Result_each_Model[[6]]
Result_each_Model[[1]]
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF6-PW_PRISM@TCGA.R")
Result_each_Model[[2]]
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF6-PW_PRISM@TCGA.R")
Result_Drug_ = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF6-PW_EachTarget.rds")
View(Result_Drug_)
Result_Drug_[["etoposide"]]
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF6-PW_EachTarget_PRISM@TCGA.R")
View(Result_Drug)
Result_Drug[["doxorubicin"]]
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF6-PW_PRISM@TCGA.R")
Result_ = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF6-PW2.rds")
View(Result_)
d = data.frame(colnames(sen_PRISM))
View(d)
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF6-PW_PRISM@TCGA.R")
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF26-allModels_Pathway")
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
N_Models = 6
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF27-ModelComparison_TrainPRISM_TestTCGA_Progeny.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF27-ModelComparison_TrainPRISM_TestTCGA_Progeny.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF27-ModelComparison_TrainPRISM_TestTCGA_Progeny.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF27-allModels_Progeny")
N_Models =6
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF26-allModels_Pathway")
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF27-ModelComparison_TrainPRISM_TestTCGA_Progeny.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF21-ModelComparison_TrainPRISM_TestTCGA_Landmark.R")
Result_ = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF21-allModels_Landmark")
N_Models = 6
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF21-allModels_Landmark")
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF21-ModelComparison_TrainPRISM_TestTCGA_Landmark.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
#saveRDS(Result_each_Model, "Final_Result/Train@PRISM_Test@TCGA_Models/RF22-allModels_DoRothEA")
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF22-allModels_DoRothEA")
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF22-ModelComparison_TrainPRISM_TestTCGA_DoRothEA.R")
saveRDS(Result_each_Model, "Final_Result/Train@PRISM_Test@TCGA_Models/RF22-allModels_DoRothEA.rds")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF21-ModelComparison_TrainPRISM_TestTCGA_Landmark.R")
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF22-allModels_DoRothEA.rds")
Result_each_Model
N_Models = 6
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF21-ModelComparison_TrainPRISM_TestTCGA_Landmark.R")
Result_each_Model = readRDS("Final_Result/Train@PRISM_Test@TCGA_Models/RF21-allModels_Landmark1.rds")
Sum_Sig = c()
for(p in 1:N_Models){
Sum_Sig = c(Sum_Sig, sum(Result_each_Model[[p]][3]<0.05))
print(which(Result_each_Model[[p]][3]<0.05))
#print(which(Result_each_Model[[p]][2]<0.05))
}
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF25-ModelComparison_TrainPRISM_TestTCGA_decoupleR.R")
saveRDS(Result_each_Model, "Final_Result/Train@PRISM_Test@TCGA_Models/RF25-allModels_dR@gsea.rds")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF26-ModelComparison_TrainPRISM_TestTCGA_PW_all.R")
saveRDS(Result_each_Model, "Final_Result/Train@PRISM_Test@TCGA_Models/RF26-allModels_Pathway.rds")
source("~/Desktop/Cancer_DRP/R/Prepare_Data/RF27-ModelComparison_TrainPRISM_TestTCGA_Progeny.R")
saveRDS(Result_each_Model, "Final_Result/Train@PRISM_Test@TCGA_Models/RF27-allModels_Progeny.rds")
