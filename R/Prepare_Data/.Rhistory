library(igraph)
install.packages("igraph")
library(igraph)
install.packages("igraph")
install.packages("igraph")
library(igraph)
BiocManager::install("igraph")
## Distribution of drug-drug similarity matrix
sim_FP = readRDS("Data/Processed_Data/Fingerprints_sim.rds")
setwd("~/Desktop/Codes/Cancer_DRP/R")
rm(list=ls())
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/")
sen_PRISM = readRDS("Processed_data/Other/Sen_PRISM_24_Drugs.rds")
WholeGenes = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF1_WholeGenes.rds")
WholeGenes = WholeGenes$Ranksum
Landmark = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF2-Landmark.rds")
Landmark = Landmark$Ranksum
Drug_Pathways = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF6-PW.rds")
Drug_Pathways = Drug_Pathways$Ranksum
OncoKB = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF8-OncoKB.rds")
OncoKB = OncoKB$Ranksum
progeny = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF7-progeny.rds")
progeny = progeny$Ranksum
dR_gsea = readRDS("Final_Result/Train@PRISM_Test@TCGA_FS/RF5-decoupleR_gsea2.rds")
dR_gsea = dR_gsea$Ranksum
Drug_FSMethods = cbind(WholeGenes, Landmark, Drug_Pathways, OncoKB, TF_activity,Pathway_activity)
# Drug_FSMethods = cbind(WholeGenes,Landmark,DoRothEA,progeny,Drug_Pathways,OncoKB,CancerGenes_GDSC,
#                        dR_aucell,dR_consensus,dR_gsva,dR_mdt,dR_mlm,dR_udt,dR_ulm,
#                        dR_viper, dR_gsea,dR_wmean,dR_wsum)
TF_activity = dR_gsea
Pathway_activity = progeny
Drug_FSMethods = cbind(WholeGenes, Landmark, Drug_Pathways, OncoKB, TF_activity,Pathway_activity)
rownames(Drug_FSMethods) = colnames(sen_PRISM)
Drug_FSMethods = Drug_FSMethods[-c(3,10,12,14),]
Drug_FSMethods_binary = ifelse(Drug_FSMethods<0.05,0,1)
plt = pheatmap::pheatmap(t(Drug_FSMethods_binary),cluster_rows = FALSE,
cluster_cols = FALSE,color = c("deeppink4", "snow2"))
pheatmap::pheatmap(t(Drug_FSMethods_binary),cluster_rows = FALSE,
cluster_cols = FALSE,color = c("deeppink4", "snow2"))
pdf(paste0("Figures/FS/All_Methods/heatmap_all_FR_Methods.pdf"), height = 4, width = 5)
plt
dev.off()
