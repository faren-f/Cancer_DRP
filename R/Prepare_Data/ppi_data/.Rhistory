library(igraph)
install.packages("igraph")
library(igraph)
install.packages("igraph")
install.packages("igraph")
library(igraph)
BiocManager::install("igraph")
rm(list=ls())
library(biomaRt)
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/ppi_Raw_data/")
protein_links = read.delim2("9606.protein.links.v11.5.txt", header = TRUE, sep = " ")
protein_info = read.delim2("9606.protein.info.v11.5.txt", header = TRUE, sep = "\t",quote="")
# Seperating 9606 from first part of the ENSPs in protein_links
col1 = strsplit(protein_links$protein1, "[.]")
colname_1 = sapply(col1, '[[', 2)
col2 = strsplit(protein_links$protein2, "[.]")
colname_2 = sapply(col2, '[[', 2)
protein_links$protein1 = colname_1
protein_links$protein2 = colname_2
rm(col1)
rm(col2)
rm(colname_1)
rm(colname_2)
length(unique(protein_links$protein2))
## Using biomaRt package
ensembl = useMart("ensembl", dataset = "hsapiens_gene_ensembl")
myFilter = "ensembl_peptide_id"
myValues = unique(protein_links$protein2)
myAttributes = c("ensembl_peptide_id", "ensembl_gene_id","hgnc_symbol")
## assemble and query the mart (for the first column of protein_links)
res_2 = getBM(attributes =  myAttributes, filters =  myFilter,
values =  myValues, mart = ensembl)
View(res_2)
View(protein_links)
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
rm(res_2)
rm(ensembl)
rm(myAttributes)
rm(myFilter)
rm(myValues)
res2 = readRDS("res2.rds")
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
View(res)
length(unique(res2$ensembl_peptide_id))
rm(res2)
p = merge(protein_links, res, by.x="protein1", by.y="ensembl_peptide_id", all=FALSE)
View(p)
p1 = merge(protein_links, res, by.x="protein1", by.y="ensembl_peptide_id", all=FALSE)
p2 = merge(protein_links, res, by.x="protein2", by.y="ensembl_peptide_id", all=FALSE)
View(p1)
View(p2)
g = protein_links[protein_links$protein2[1:50],]
View(g)
protein_links$protein2[1:10]
protein_links[protein_links$protein2[1:10],]
g = protein_links$protein2[1:10]
p2 = merge(protein_links, res, by.x="protein2", by.y="ensembl_peptide_id")
g = protein_links$protein2[1:10]
p2 = merge(g, res, by.y="ensembl_peptide_id", all=FALSE)
p3 = merge(g, res, by="ensembl_peptide_id", all=FALSE)
p3 = merge(res,g, by="ensembl_peptide_id", all=FALSE)
View(p2)
View(protein_links)
df.1 <- data.frame(class = c(1, 2, 3), prob = c(0.5, 0.7, 0.3))
df.2 <- data.frame(object = c('A', 'B', 'D', 'F', 'C'), class = c(2, 1, 2, 3, 1))
View(df.1)
View(df.2)
k = merge(df.2, df.1)
View(k)
p2 = merge(protein_links, res, by.x="protein2", by.y="ensembl_peptide_id",sort=FALSE)
library(dplyr)
library(dplyr)
View(res)
View(protein_links)
colnames(res) = c("protein1","gene1","symbol1")
p3 = inner_join(protein_links, res, by = "protein1")
View(p3)
colnames(res) = c("protein2","gene1","symbol1")
p3 = inner_join(protein_links, res, by = "protein2")
View(p3)
e = duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
sum(e)
e = which(duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res)))
res_deplicated = duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
unique_res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res)
unique_res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
unique_res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
k = keys(res)
#deplicated_res = duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
res1 = res
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
#deplicated_res = duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
View(res)
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
View(res1)
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
View(join1)
View(join2)
View(res)
join1 = inner_join(protein_links$protein1, res1, by = "protein1")
join1 = inner_join(data.frame(protein_links$protein1), res1, by = "protein1")
join = cbind(join1[,c(1,2,4,5)],join2[,c(4,5)])
View(join)
join = join[,c(1,2,3,5,4,6)]
rm(list=ls())
library(biomaRt)
library(dplyr)
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/ppi_Raw_data/")
protein_links = read.delim2("9606.protein.links.v11.5.txt", header = TRUE, sep = " ")
protein_info = read.delim2("9606.protein.info.v11.5.txt", header = TRUE, sep = "\t",quote="")
# Seperating 9606 from first part of the ENSPs in protein_links
col1 = strsplit(protein_links$protein1, "[.]")
colname_1 = sapply(col1, '[[', 2)
col2 = strsplit(protein_links$protein2, "[.]")
colname_2 = sapply(col2, '[[', 2)
protein_links$protein1 = colname_1
protein_links$protein2 = colname_2
rm(col1)
rm(col2)
rm(colname_1)
rm(colname_2)
View(protein_links)
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
View(res)
deplicated_res = which(duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res)))
View(res)
#deplicated_res = which(duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res)))
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
rm(deplicated_res)
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
View(res1)
join1 = inner_join(protein_links, res1, by = "protein1")
View(join1)
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
View(join2)
View(res2)
join = cbind(join1[,c(1,2,3,4,5)],join2[,c(4,5)])
View(join)
join = join[,c(1,2,4,6,5,7,3)]
join = cbind(join1[,c(1,2,3,4,5)],join2[,c(4,5)])
join = join[,c(1,2,4,6,5,7,3)]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(protein_links)
join[protein_links$protein1 == "ENSP00000254722" & protein_links$protein2 == "ENSP00000355370",]
join[protein_links$protein1 == "ENSP00000254722" & protein_links$protein2 == "ENSP00000355370",]
View(join)
protein_links[protein_links$protein1 == "ENSP00000254722" & protein_links$protein2 == "ENSP00000355370",]
View(res)
View(res1)
View(res2)
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(res)
View(join2)
View(join2)
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
#deplicated_res = which(duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res)))
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
join = cbind(join1[,c(1,2,3,4,5)],join2[,c(4,5)])
join = join[,c(1,2,4,6,5,7,3)]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join = cbind(join1,join2)
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
View(join)
sum(join2$symbol2 == "")
join = join[,c(1,2,4,9,5,10,3)]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(res)
which(res$hgnc_symbol == "")
which(res$hgnc_symbol == " ")
which(res$hgnc_symbol == "")
res["ENSP00000394107",]
res[16646,]
res[res$ensembl_peptide_id=="ENSP00000394107",]
r = res$hgnc_symbol %>% mutate_all(na_if,"")
r = res %>% mutate_all(na_if,"")
View(r)
which(res$ensembl_gene_id == "")
which(res$ensembl_peptide_id == "")
which(res$hgnc_symbol == "")
r = mutate_all(res, na_if,"")
View(r)
rm(list=ls())
library(biomaRt)
library(dplyr)
setwd("~/Desktop/Cancer_DRP/R/Prepare_Data/ppi_Raw_data/")
protein_links = read.delim2("9606.protein.links.v11.5.txt", header = TRUE, sep = " ")
protein_info = read.delim2("9606.protein.info.v11.5.txt", header = TRUE, sep = "\t",quote="")
# Seperating 9606 from first part of the ENSPs in protein_links
col1 = strsplit(protein_links$protein1, "[.]")
colname_1 = sapply(col1, '[[', 2)
col2 = strsplit(protein_links$protein2, "[.]")
colname_2 = sapply(col2, '[[', 2)
protein_links$protein1 = colname_1
protein_links$protein2 = colname_2
rm(col1)
rm(col2)
rm(colname_1)
rm(colname_2)
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
#deplicated_res = which(duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res)))
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
res = mutate_all(res, na_if,"")
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
join = cbind(join1,join2)
join = join[,c(1,2,4,9,5,10,3)]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
join[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
View(join)
#saveRDS(res,"res.rds")
r = readRDS("res.rds")
join = cbind(join1,join2)
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
# Remove columns that are compeletly same in res
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
# convert blank cells in the res to "NA"
res = mutate_all(res, na_if,"")
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
join = cbind(join1,join2)
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
# Remove columns that are compeletly same in res
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
join = cbind(join1,join2)
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join = cbind(join1,join2)
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
join = data.frame(j1 = join1,j2 = join2)
join[join$j1.protein1 == "ENSP00000254722" & join$j2.protein2 == "ENSP00000355370",]
join[join$j1.protein1 == "ENSP00000254722" & join$j1.protein2 == "ENSP00000355370",]
join = cbind(join1,join2)
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(join1)
View(join2)
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
View(res)
# Remove columns that are compeletly same in res
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
View(res)
length(res)
nrow(res)
rownames(res) = 1:nrow(res)
View(res)
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
join = cbind(join1,join2)
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(res1)
res[16646,]
which(duplicated(res, incomparables=FALSE, fromLast=FALSE, by=key(res)))
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
# Remove columns that are compeletly same in res
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
rownames(res) = 1:nrow(res)
View(res)
# convert blank cells in the res to "NA"
res = mutate_all(res, na_if,"")
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
join2 = inner_join(protein_links, res2, by = "protein2")
join = cbind(join1,join2)
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
rm(r)
#saveRDS(res,"res.rds")
res = readRDS("res.rds")
# Remove columns that are compeletly same in res
res = unique(res, incomparables=FALSE, fromLast=FALSE, by=key(res))
rownames(res) = 1:nrow(res)
# convert blank cells in the res to "NA"
res = mutate_all(res, na_if,"")
res1 = res
colnames(res1) = c("protein1","gene1","symbol1")
join1 = inner_join(protein_links, res1, by = "protein1")
View(protein_links)
join1 = inner_join(protein_links, res1, by = "protein1")
View(join1)
View(join2)
View(protein_links)
sum(protein_links$protein2 %in% res2$protein2)
protein_links$protein2 %in% res2$protein2
PL1 = protein_links[protein_links$protein1 %in% res2$protein1,]
View(PL1)
protein_links$protein1 %in% res2$protein1
PL1 = protein_links[protein_links$protein1 %in% res1$protein1,]
View(PL1)
join1 = inner_join(PL1, res1, by = "protein1")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
PL2 = protein_links$protein2 %in% res2$protein2
join2 = inner_join(PL2, res2, by = "protein2")
res2 = res
colnames(res2) = c("protein2","gene2","symbol2")
PL2 = protein_links$protein2 %in% res2$protein2
join2 = inner_join(PL2, res2, by = "protein2")
PL2 = protein_links[protein_links$protein2 %in% res2$protein2,]
join2 = inner_join(PL2, res2, by = "protein2")
join = cbind(join1,join2)
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(PL1)
View(join1)
View(join)
rownames(join1) = 1:nrow(join1)
rownames(join2) = 1:nrow(join2)
join = cbind(join1,join2)
View(join)
join1[join1$protein1 == "ENSP00000254722" & join1$protein2 == "ENSP00000355370",]
join2[join2$protein1 == "ENSP00000254722" & join2$protein2 == "ENSP00000355370",]
join[join$protein1 == "ENSP00000254722" & join$protein2 == "ENSP00000355370",]
View(join1)
View(res)
View(res1)
